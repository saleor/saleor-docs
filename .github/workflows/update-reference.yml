name: Update reference

on:
  workflow_dispatch:
  schedule:
    - cron: "0 8 * * 1" # At 08:00 on Monday

jobs:
  update-reference:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
        with:
          ref: main

      - uses: actions/setup-node@v3
        with:
          node-version: "14"

      - uses: bahmutov/npm-install@v1

      - run: npx docusaurus graphql-to-doc --pretty -s https://master.staging.saleor.cloud/graphql/

      - run: git status

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          branch: update-api-reference
          commit-message: Update API reference
          title: "Update API reference"
          body: |
            Pull request auto-generated by bot
          labels: |
            :robot: bot
